<!DOCTYPE html>
<html layout:decorate="~{layout}">
  <div layout:fragment="content">
    <link rel="stylesheet" type="text/css" th:href="@{/css/index.css}" />
    <header th:replace="~{header :: headerFragment}"></header>

    <main>
      <div class="container my-5">
        <div class="row">
          <!-- ナビゲーション -->
          <div class="col-md-2">
            <nav class="nav nav-pills flex-column position-fixed">
              <a class="nav-link" href="#item-1">個人情報</a>
              <a class="nav-link" href="#item-2">投稿履歴</a>
              <a class="nav-link" href="#item-3">お気に入り</a>
              <a class="nav-link" href="#item-4">会員退会</a>
            </nav>
          </div>
          <!-- マイページ -->
          <div class="col-md-10">
            <!-- 個人情報出力 -->
            <div class="row p-3 text-center justify-content-center" id="item-1">
              <div class="col-md-6">
                <!-- NAV LINK Loacation 修正必要 -->
                <div
                  data-bs-spy="scroll"
                  data-bs-target="navbar-myPage"
                  data-bs-offset="0"
                  tabindex="0"
                >
                  <h2 class="p-3">個人情報</h2>
                  <ul class="list-group p-3">
                    <li class="list-group-item">
                      <strong>ニックネーム</strong>
                    </li>
                    <li class="list-group-item" th:text="${user.username}"></li>
                    <li class="list-group-item">
                      <a th:href="@{mypage/repassword}" class="btn btn-primary"
                        >パスワード変更</a
                      >
                    </li>
                    <li class="list-group-item">
                      <strong>メールアドレス</strong>
                    </li>
                    <li class="list-group-item" th:text="${user.email}"></li>
                    <li class="list-group-item">
                      <a th:href="@{mypage/reemail}" class="btn btn-primary"
                        >E-Mail変更</a
                      >
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="row justify-content-center p-5">
              <div class="col-md-7">
                <hr />
              </div>
            </div>
            <!-- 投稿履歴リスト出力 -->
            <div class="row p-3" id="item-2">
              <h2 class="p-3 text-center" th:text="${user.username + '様が投稿したレシピ' }"></h2>
              <div class="recipe_list">
              <div class="row p-2">
                <div th:if="${recipes.empty}" class="col-md-12 text-center">
                  <h5>作成したレシピがありません。</h5>
                </div>
                <div th:each="recipe : ${recipes}" class="col-sm-4 h-100" >
                  <div class="card border-0 a_none">
                    <a th:href="@{|/recipe/detail/${recipe.id}|}" class="btn btn-light">
                      <div class="image-container zoom">
                        <img class="card-img-top thumb-size" th:if="${not #strings.isEmpty(recipe.thumbnail)}"
                             th:src="@{__${recipe.thumbnail.substring(16)}__}" alt="Card image cap" />
                        <i class="like-btn fa-solid fa-heart like_color">
                          <span class="like-count" th:text="${#lists.size(recipe.voter)}"></span>
                        </i>
                      </div>
                    </a>
                    <a th:href="@{|/recipe/detail/${recipe.id}|}" class="text-left a_none">
                      <div class="card-body">
                        <h5 class="card-title" th:text="${recipe.recipeName}"></h5>
                        <h7 class="card-title" th:if="${recipe.author != null}" th:text="@{|作成者 ${recipe.author.username}|}"></h7>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
              </div>
              <div class="row p-2 text-center" th:if="${not recipes.empty}">
                <div class="col-md-12">
                  <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                      <li th:each="pageNumber : ${#numbers.sequence(0, recipeTotalPage - 1)}"
                          th:class="${recipePage == pageNumber ? 'page-item active' : 'page-item'}">
                        <a class="page-link"
                           th:href="@{/mypage(recipePage=${pageNumber}, recipeSize=${recipeSize}, likedPage=${likedPage}, likedSize=${likedSize})}"
                           th:text="${pageNumber + 1}"></a>
                      </li>
                    </ul>
                  </nav>
                </div>
              </div>
            </div>
            <div class="row justify-content-center p-5">
              <div class="col-md-7">
                <hr />
              </div>
            </div>
            <!-- お気に入りリスト出力 -->
            <div class="row p-3" id="item-3">
              <h2 class="p-3 text-center" th:text="${user.username + '様がいいねしたレシピ' }"></h2>
              <div class="recipe_list">
                <div class="row p-2">
                  <div th:if="${likedRecipes.empty}" class="col-md-12 text-center">
                    <h5>いいねしたレシピがありません。</h5>
                  </div>
                  <div th:each="likedRecipe : ${likedRecipes}" class="col-sm-4 h-100" >
                    <div class="card border-0 a_none">
                      <a th:href="@{|/recipe/detail/${likedRecipe.id}|}" class="btn btn-light">
                        <div class="image-container zoom">
                          <img class="card-img-top thumb-size" th:if="${not #strings.isEmpty(likedRecipe.thumbnail)}"
                               th:src="@{__${likedRecipe.thumbnail.substring(16)}__}" alt="Card image cap" />
                          <i class="like-btn fa-solid fa-heart like_color">
                            <span class="like-count" th:text="${#lists.size(likedRecipe.voter)}"></span>
                          </i>
                        </div>
                      </a>
                      <a th:href="@{|/recipe/detail/${likedRecipe.id}|}" class="text-left a_none">
                        <div class="card-body">
                          <h5 class="card-title" th:text="${likedRecipe.recipeName}"></h5>
                          <h7 class="card-title" th:if="${likedRecipe.author != null}" th:text="@{|作成者 ${likedRecipe.author.username}|}"></h7>
                        </div>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row p-2 justify-content-center text-center" th:if="${not likedRecipes.empty}">
                <div class="col-md-12">
                  <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                      <li th:each="pageNumber : ${#numbers.sequence(0, likedTotalPage - 1)}"
                          th:class="${likedPage == pageNumber ? 'page-item active' : 'page-item'}">
                        <a class="page-link" th:href="@{/mypage(recipePage=${recipePage}, recipeSize=${recipeSize}, likedPage=${pageNumber}, likedSize=${likedSize})}" th:text="${pageNumber + 1}"></a>
                      </li>
                    </ul>
                  </nav>
                </div>
              </div>

            </div>
            <div class="row justify-content-center p-5">
              <div class="col-md-7">
                <hr />
              </div>
            </div>



            <div class="row m-5 p-5"></div>
            <div class="row m-5 p-5"></div>
            <div class="row m-5 p-5"></div>
            <!-- 会員退会 -->
            <div class="row" id="item-4">
              <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <a class="btn btn-outline-secondary" th:href="@{/delete_form}"
                  >会員退会</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="bg-light">
      <div class="container py-3">
        <p class="text-center">&copy; レシピサイト</p>
      </div>
    </footer>

    <!-- Include Bootstrap JS file -->

  </div>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script layout:fragment="script" type='text/javascript'>

</script>
</html>
